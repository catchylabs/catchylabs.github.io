(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{108:function(e,t,r){e.exports=r.p+"static/media/app-logo.3be78e48.png"},140:function(e,t,r){"use strict";r.d(t,"a",(function(){return ke}));var n,o,a=r(7),c=r.n(a),s=r(11),i=r.n(s),l=r(194),u=r(0),d=r(20),b=r(6),j=Object(b.d)({name:"auth",initialState:{user:null,access_token:null,refresh_token:null},reducers:{setCredentials:function(e,t){e.user=t.payload.user,e.access_token=t.payload.access_token,e.refresh_token=t.payload.refresh_token}}}),p=j.actions.setCredentials,f=j.reducer,O=function(e){return e.auth},h=function(){var e=Object(d.e)(O);return Object(u.useMemo)((function(){return e}),[e])},x=r(5),y=r.n(x),g=r(2),m=r(4),v=r(42),w=r(8),S=r(108),k=r.n(S),P=r(87),C=r(27),E=r(141),T=r(69),_=r(50);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var z=Object(C.d)({baseUrl:null==(n=E.a.manifest)||null==(o=n.extra)?void 0:o.baseUrl,headers:{"content-type":"application/json"}}),I=function(e,t,r){var n,o,a,c,s,l,u,d,b;return i.a.async((function(j){for(;;)switch(j.prev=j.next){case 0:return n=t.getState().auth.access_token,o=t.getState().auth.refresh_token,j.next=4,i.a.awrap(z(L(L({},e),{},{headers:{authorization:"Bearer "+n}}),t,r));case 4:if(!(a=j.sent).error||403!==a.error.status||"TOKEN_EXPIRED"!==a.error.data.error_code&&"TOKEN_INVALID"!==a.error.data.error_code){j.next=23;break}return j.next=8,i.a.awrap(z({url:"api/v1/refresh-token",method:"POST",headers:{authorization:"Bearer "+o}},t,r));case 8:if(!(c=j.sent).data){j.next=21;break}return s=c.data,l=s.access_token,u=s.refresh_token,d={user:Object(T.a)(l),access_token:l,refresh_token:u},t.dispatch(p(d)),b=JSON.stringify(d),j.next=16,i.a.awrap(_.a.setItem("@user",b));case 16:return j.next=18,i.a.awrap(z(L(L({},e),{},{headers:{authorization:"Bearer "+l}}),t,r));case 18:a=j.sent,j.next=23;break;case 21:t.dispatch(p({})),_.a.removeItem("@user");case 23:return j.abrupt("return",a);case 24:case"end":return j.stop()}}),null,null,null,Promise)},B=Object(P.a)({reducerPath:"api",baseQuery:I,endpoints:function(){return{}}}),N=B.injectEndpoints({endpoints:function(e){return{login:e.mutation({query:function(e){return{url:"api/v1/login",method:"POST",body:e}},transformResponse:function(e){var t=e.access_token,r=e.refresh_token;return{user:Object(T.a)(t),access_token:t,refresh_token:r}},onQueryStarted:function(e,t){var r=t.dispatch,n=t.queryFulfilled;return function(){var e,t,o;return i.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,i.a.awrap(n);case 3:return e=a.sent,t=e.data,r(p(t)),o=JSON.stringify(t),a.next=9,i.a.awrap(_.a.setItem("@user",o));case 9:a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.log(a.t0);case 14:case"end":return a.stop()}}),null,null,[[0,11]],Promise)}()}})}}}).useLoginMutation,R=r(24),q=r(3),A=function(e){var t=e.text;return Object(q.jsx)(g.a,{style:W.container,children:Object(q.jsx)(R.a,{style:W.text,children:t})})},W=m.a.create({container:{padding:8,borderWidth:1,borderColor:"red",borderRadius:4,width:"100%",marginTop:8,marginBottom:16},text:{color:"red",fontSize:14}}),M=r(12),F=r.n(M),J=r(128),G={primary:"#32CE57",white:"#ffffff",grey:"#d9d9d9",lightGrey:"#f5f5f7",red:"#FF0056",lightRed:"#E10958"},Q=["label","error"];function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V=function(e){var t=e.label,r=e.error,n=F()(e,Q),o=r?Y:X;return Object(q.jsxs)(g.a,{style:o.containerStyle,children:[t&&Object(q.jsx)(R.a,{style:o.labelStyle,children:t}),Object(q.jsx)(J.a,K({style:o.inputStyle},n)),r&&Object(q.jsx)(R.a,{style:o.errorLabelStyle,children:r})]})},X=m.a.create({containerStyle:{width:"100%"},inputStyle:{height:48,paddingLeft:16,borderWidth:1,borderColor:G.grey,borderRadius:4},labelStyle:{fontSize:12,marginBottom:4},errorLabelStyle:{fontSize:12,color:G.red,marginTop:4}}),Y=m.a.create({containerStyle:{width:"100%"},inputStyle:{height:48,paddingLeft:16,borderWidth:1,borderColor:G.red,borderRadius:4},labelStyle:{fontSize:12,marginBottom:4},errorLabelStyle:{fontSize:12,color:G.red,marginTop:4}}),H=r(75),Z=function(e){var t=e.text,r=e.onClick,n=e.disabled,o=e.style,a=[$.button];return o&&a.push(o),Object(q.jsx)(H.a,{style:a,onPress:r,disabled:n,children:Object(q.jsx)(R.a,{style:$.text,children:t})})},$=m.a.create({button:{height:48,alignItems:"center",justifyContent:"center",textTransform:"uppercase",width:"100%",backgroundColor:G.primary,borderRadius:4},text:{fontSize:14,color:G.white}}),ee=function(e){var t=e.children;return Object(q.jsx)(g.a,{style:te.container,children:t})},te=m.a.create({container:{width:"100%",marginBottom:16}});function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var oe=function(e){var t,r,n=e.navigation,o=Object(u.useState)({username:"",password:""}),a=c()(o,2),s=a[0],l=a[1],d=N(),b=c()(d,2),j=b[0],p=b[1];return Object(q.jsxs)(g.a,{style:ae.container,children:[Object(q.jsx)(v.a,{source:k.a,style:{width:200,height:60,marginBottom:48}}),p.isError&&Object(q.jsx)(A,{text:null==(t=p.error)||null==(r=t.data)?void 0:r.message}),Object(q.jsx)(ee,{children:Object(q.jsx)(V,{placeholder:"Username",label:"Enter username*",value:s.username,onChangeText:function(e){l((function(t){return ne(ne({},t),{},{username:e})}))},secureTextEntry:!1})}),Object(q.jsx)(ee,{children:Object(q.jsx)(V,{placeholder:"Password",label:"Enter password*",secureTextEntry:!0,value:s.password,onChangeText:function(e){l((function(t){return ne(ne({},t),{},{password:e})}))}})}),Object(q.jsx)(ee,{children:Object(q.jsx)(Z,{text:"Login",onClick:function(){return i.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.awrap(j({username:s.username,password:s.password}).unwrap());case 2:n.navigate("calculator");case 3:case"end":return e.stop()}}),null,null,null,Promise)},disabled:p.isLoading})})]})},ae=m.a.create({container:ne({flex:1,alignItems:"center",padding:24},w.a.select({web:{width:400},default:"100%"})),loginButton:{width:"100%"}}),ce=function(e){return Number.parseFloat(e.replace(/,/g,"."))},se=B.injectEndpoints({endpoints:function(e){return{calculate:e.mutation({query:function(e){var t=e.operand1,r=e.operand2,n=e.operator,o=e.client_id,a="";switch(n){case"+":a="add";break;case"-":a="subtract";break;case"*":a="multiply";break;case"/":a="divide"}return{url:"api/v1/calculators/"+a,method:"POST",body:{number1:ce(t),number2:ce(r),client_id:o}}}}),fetchSessions:e.query({query:function(e){return{url:"/api/v1/students/"+e+"/sessions",method:"GET"}}}),sessionStart:e.mutation({query:function(){return{url:"api/v1/sessions/start",method:"POST"}}}),sessionStop:e.mutation({query:function(e){return{url:"api/v1/sessions/"+e.sessionId+"/end",method:"POST",body:""}}})}}}),ie=se.useCalculateMutation,le=se.useFetchSessionsQuery,ue=se.useSessionStartMutation;se.useSessionStopMutation;function de(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?de(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var je,pe=function(e){var t=e.text,r=e.onClick,n=e.disabled;return Object(q.jsx)(H.a,{style:Oe.button,onPress:function(){r(t)},disabled:n,children:Object(q.jsx)(R.a,{style:Oe.buttonText,children:t})})},fe=function(e){var t=e.calculate,r=e.loading,n=e.result,o=Object(u.useState)({operand1:"",operand2:"",operator:"",result:null!=n?n:""}),a=c()(o,2),s=a[0],i=a[1];Object(u.useEffect)((function(){i((function(e){return be(be({},e),{},{result:n})}))}),[n]);var l=function(e){var n=s.operator?"operand2":"operand1";if("AC"===e)i({operand1:"",operand2:"",operator:"",result:""});else if(/[\d,]/g.test(e)){if(/,/g.test(e)&&/,/g.test(s[n]))return;i((function(t){return t.result?{operand1:e,operand2:"",operator:"",result:""}:be(be({},t),{},y()({},n,s[n].concat(e)))}))}else if(/[/x\-*+]/.test(e)){if(!s.operand1)return;i((function(t){return be(be({},t),{},{operator:e})}))}else"="===e&&(r||t(s.operand1,s.operand2,s.operator))};return Object(q.jsxs)(g.a,{style:Oe.container,children:[Object(q.jsx)(g.a,{style:Oe.screen,children:Object(q.jsxs)(R.a,{style:Oe.screenText,children:[s.operand1," ",s.operator," ",s.operand2,s.result?Object(q.jsxs)(R.a,{style:Oe.resultText,children:["= ",s.result.toString().replace(/\./g,",")]}):null]})}),Object(q.jsxs)(g.a,{style:Oe.buttonGroup,children:[Object(q.jsxs)(g.a,{style:Oe.row,children:[Object(q.jsx)(pe,{text:"AC",onClick:l}),Object(q.jsx)(pe,{text:"",onClick:l,disabled:!0}),Object(q.jsx)(pe,{text:"",onClick:l,disabled:!0}),Object(q.jsx)(pe,{text:"/",onClick:l})]}),Object(q.jsxs)(g.a,{style:Oe.row,children:[Object(q.jsx)(pe,{text:"7",onClick:l}),Object(q.jsx)(pe,{text:"8",onClick:l}),Object(q.jsx)(pe,{text:"9",onClick:l}),Object(q.jsx)(pe,{text:"*",onClick:l})]}),Object(q.jsxs)(g.a,{style:Oe.row,children:[Object(q.jsx)(pe,{text:"4",onClick:l}),Object(q.jsx)(pe,{text:"5",onClick:l}),Object(q.jsx)(pe,{text:"6",onClick:l}),Object(q.jsx)(pe,{text:"-",onClick:l})]}),Object(q.jsxs)(g.a,{style:Oe.row,children:[Object(q.jsx)(pe,{text:"1",onClick:l}),Object(q.jsx)(pe,{text:"2",onClick:l}),Object(q.jsx)(pe,{text:"3",onClick:l}),Object(q.jsx)(pe,{text:"+",onClick:l})]}),Object(q.jsxs)(g.a,{style:Oe.row,children:[Object(q.jsx)(pe,{text:"0",onClick:l}),Object(q.jsx)(pe,{text:"",onClick:l,disabled:!0}),Object(q.jsx)(pe,{text:",",onClick:l}),Object(q.jsx)(pe,{text:"=",onClick:l,disabled:r})]})]})]})},Oe=m.a.create({container:{width:"100%",marginTop:24,maxWidth:500,height:330},row:{display:"flex",flex:4,height:48,width:"100%",flexDirection:"row"},buttonGroup:{width:"100%",height:264},button:{flex:1,margin:4,height:48,alignItems:"center",justifyContent:"center",textTransform:"uppercase",width:"100%",backgroundColor:G.primary,borderRadius:4},buttonText:{color:"#ffffff",fontWeight:"bold",fontSize:16},screen:{padding:8,justifyContent:"center",backgroundColor:"#dbdbdb",marginBottom:16,height:80},screenText:{fontWeight:"bold",fontSize:24,textAlign:"right"},resultText:{fontWeight:"bold",fontSize:28,textAlign:"right"}}),he=m.a.create({container:{flex:1,width:"100%",alignItems:"center",padding:24,marginTop:48}}),xe=function(){var e,t,r=h(),n=ie(),o=c()(n,2),a=o[0],s=o[1],l=s.isLoading,u=s.data,d=le(null==(e=r.user)?void 0:e.id),b=d.isLoading,j=d.data,p=ue(),f=c()(p,2),O=f[0],x=f[1],y=x.error,m=x.isError,v=x.isLoading,S=x.isSuccess;return b?Object(q.jsx)(g.a,{style:he.container,children:Object(q.jsx)(R.a,{children:"Loading..."})}):j&&j.is_active?Object(q.jsxs)(g.a,{style:he.container,children:[m&&Object(q.jsx)(A,{text:null==y||null==(t=y.data)?void 0:t.message}),S?Object(q.jsx)(fe,{calculate:function(e,t,r){return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.awrap(a({operand1:e,operand2:t,operator:r,client_id:w.a.OS}));case 2:case"end":return n.stop()}}),null,null,null,Promise)},loading:l,result:null==u?void 0:u.result}):Object(q.jsx)(Z,{onClick:function(){O()},text:v?"Starting":"Start",disabled:v})]}):Object(q.jsx)(g.a,{style:he.container,children:Object(q.jsx)(A,{text:"You don't have any active session"})})},ye=Object(l.a)(),ge=function(){var e=h(),t=Object(u.useState)(!0),r=c()(t,2),n=r[0],o=r[1],a=Object(u.useMemo)((function(){return e&&e.user}),[null==e?void 0:e.user]),s=Object(d.d)();return Object(u.useEffect)((function(){!function(){var e,t;i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,i.a.awrap(_.a.getItem("@user"));case 3:e=r.sent,t=null!=e?JSON.parse(e):null,e&&s(p(t)),o(!1),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),o(!1);case 12:case"end":return r.stop()}}),null,null,[[0,9]],Promise)}()}),[s,p]),n?null:Object(q.jsx)(ye.Navigator,{initialRouteName:"calculator",screenOptions:{header:function(){return null}},children:a?Object(q.jsx)(ye.Screen,{name:"calculator",component:xe}):Object(q.jsx)(ye.Screen,{name:"login",component:oe})})},me=Object(b.d)({name:"calculator",initialState:{activeSession:void 0},reducers:{setActiveSession:function(e,t){e.activeSession=t.payload.session}}}),ve=(me.actions.setActiveSession,me.reducer),we=Object(b.a)({reducer:(je={},y()(je,B.reducerPath,B.reducer),y()(je,"auth",f),y()(je,"calculator",ve),je),middleware:function(e){return e().concat(B.middleware)}}),Se=r(193);function ke(){return Object(q.jsx)(d.a,{store:we,children:Object(q.jsx)(Se.a,{children:Object(q.jsx)(ge,{})})})}},145:function(e,t,r){e.exports=r(186)}},[[145,1,2]]]);
//# sourceMappingURL=app.72dc04ae.chunk.js.map
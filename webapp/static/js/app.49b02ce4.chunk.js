(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{115:function(e,t,r){e.exports=r.p+"static/media/app-logo.3be78e48.png"},151:function(e,t,r){"use strict";r.d(t,"a",(function(){return Ae}));var n,a,o=r(9),c=r.n(o),s=r(6),i=r.n(s),u=r(206),l=r(0),d=r(20),b=r(7),j=Object(b.d)({name:"auth",initialState:{user:null,access_token:null,refresh_token:null},reducers:{setCredentials:function(e,t){e.user=t.payload.user,e.access_token=t.payload.access_token,e.refresh_token=t.payload.refresh_token}}}),f=j.actions.setCredentials,p=j.reducer,h=function(e){return e.auth},O=function(){var e=Object(d.e)(h);return Object(l.useMemo)((function(){return e}),[e])},x=r(5),y=r.n(x),g=r(4),m=r(3),v=r(45),w=r(8),S=r(115),k=r.n(S),P=r(93),C=r(31),T=r(153),E=r(75),B=r(54);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=Object(C.d)({baseUrl:null==(n=T.a.manifest)||null==(a=n.extra)?void 0:a.baseUrl,headers:{"content-type":"application/json"}}),I=function(e,t,r){var n,a,o,c,s,u,l,d,b;return i.a.async((function(j){for(;;)switch(j.prev=j.next){case 0:return n=t.getState().auth.access_token,a=t.getState().auth.refresh_token,j.next=4,i.a.awrap(L(D(D({},e),{},{headers:{authorization:"Bearer "+n}}),t,r));case 4:if(!(o=j.sent).error||403!==o.error.status||"TOKEN_EXPIRED"!==o.error.data.error_code&&"TOKEN_INVALID"!==o.error.data.error_code){j.next=23;break}return j.next=8,i.a.awrap(L({url:"api/v1/refresh-token",method:"POST",headers:{authorization:"Bearer "+a}},t,r));case 8:if(!(c=j.sent).data){j.next=21;break}return s=c.data,u=s.access_token,l=s.refresh_token,d={user:Object(E.a)(u),access_token:u,refresh_token:l},t.dispatch(f(d)),b=JSON.stringify(d),j.next=16,i.a.awrap(B.a.setItem("@user",b));case 16:return j.next=18,i.a.awrap(L(D(D({},e),{},{headers:{authorization:"Bearer "+u}}),t,r));case 18:o=j.sent,j.next=23;break;case 21:t.dispatch(f({})),B.a.removeItem("@user");case 23:return j.abrupt("return",o);case 24:case"end":return j.stop()}}),null,null,null,Promise)},R=Object(P.a)({reducerPath:"api",baseQuery:I,endpoints:function(){return{}},tagTypes:["session"]}),z=R.injectEndpoints({endpoints:function(e){return{login:e.mutation({query:function(e){return{url:"api/v1/login",method:"POST",body:e}},transformResponse:function(e){var t=e.access_token,r=e.refresh_token;return{user:Object(E.a)(t),access_token:t,refresh_token:r}},onQueryStarted:function(e,t){var r=t.dispatch,n=t.queryFulfilled;return function(){var e,t,a;return i.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,i.a.awrap(n);case 3:return e=o.sent,t=e.data,r(f(t)),a=JSON.stringify(t),o.next=9,i.a.awrap(B.a.setItem("@user",a));case 9:o.next=14;break;case 11:o.prev=11,o.t0=o.catch(0),console.log(o.t0);case 14:case"end":return o.stop()}}),null,null,[[0,11]],Promise)}()}})}}}).useLoginMutation,A=r(19),W=r(1),F=function(e){var t=e.text;return Object(W.jsx)(g.a,{style:M.container,children:Object(W.jsx)(A.a,{style:M.text,children:t})})},M=m.a.create({container:{padding:8,borderWidth:1,borderColor:"red",borderRadius:4,width:"100%",marginTop:8,marginBottom:16},text:{color:"red",fontSize:14}}),N=r(12),q=r.n(N),J=r(135),G={primary:"#32CE57",white:"#ffffff",grey:"#d9d9d9",lightGrey:"#f5f5f7",red:"#FF0056",lightRed:"#E10958"},K=["label","error"];function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V=function(e){var t=e.label,r=e.error,n=q()(e,K),a=r?X:Y;return Object(W.jsxs)(g.a,{style:a.containerStyle,children:[t&&Object(W.jsx)(A.a,{style:a.labelStyle,children:t}),Object(W.jsx)(J.a,U({style:a.inputStyle},n)),r&&Object(W.jsx)(A.a,{style:a.errorLabelStyle,children:r})]})},Y=m.a.create({containerStyle:{width:"100%"},inputStyle:{height:48,paddingLeft:16,borderWidth:1,borderColor:G.grey,borderRadius:4},labelStyle:{fontSize:12,marginBottom:4},errorLabelStyle:{fontSize:12,color:G.red,marginTop:4}}),X=m.a.create({containerStyle:{width:"100%"},inputStyle:{height:48,paddingLeft:16,borderWidth:1,borderColor:G.red,borderRadius:4},labelStyle:{fontSize:12,marginBottom:4},errorLabelStyle:{fontSize:12,color:G.red,marginTop:4}}),H=r(53),Z=function(e){var t=e.text,r=e.onClick,n=e.disabled,a=e.style,o=e.type,c=void 0===o?"primary":o,s=[$.button],i=[$.text];return"secondary"===c&&(s.push($.buttonSecondary),i.push($.textSecondary)),a&&s.push(a),Object(W.jsx)(H.a,{style:s,onPress:r,disabled:n,children:Object(W.jsx)(A.a,{style:i,children:t})})},$=m.a.create({button:{height:48,alignItems:"center",justifyContent:"center",textTransform:"uppercase",width:"100%",backgroundColor:G.primary,borderRadius:4},buttonSecondary:{backgroundColor:"transparent",borderColor:G.primary,borderWidth:1,borderStyle:"solid"},text:{fontSize:14,color:G.white},textSecondary:{color:G.primary}}),ee=function(e){var t=e.children;return Object(W.jsx)(g.a,{style:te.container,children:t})},te=m.a.create({container:{width:"100%",marginBottom:16}});function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ae=function(e){var t,r,n=e.navigation,a=Object(l.useState)({username:"",password:""}),o=c()(a,2),s=o[0],u=o[1],d=z(),b=c()(d,2),j=b[0],f=b[1];return Object(W.jsxs)(g.a,{style:oe.container,children:[Object(W.jsx)(v.a,{source:k.a,style:{width:200,height:60,marginBottom:48}}),f.isError&&Object(W.jsx)(F,{text:null==(t=f.error)||null==(r=t.data)?void 0:r.message}),Object(W.jsx)(ee,{children:Object(W.jsx)(V,{placeholder:"Username",label:"Enter username*",value:s.username,onChangeText:function(e){u((function(t){return ne(ne({},t),{},{username:e})}))},secureTextEntry:!1})}),Object(W.jsx)(ee,{children:Object(W.jsx)(V,{placeholder:"Password",label:"Enter password*",secureTextEntry:!0,value:s.password,onChangeText:function(e){u((function(t){return ne(ne({},t),{},{password:e})}))}})}),Object(W.jsx)(ee,{children:Object(W.jsx)(Z,{text:"Login",onClick:function(){return i.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.awrap(j({username:s.username,password:s.password}).unwrap());case 2:n.replace("apps");case 3:case"end":return e.stop()}}),null,null,null,Promise)},disabled:f.isLoading})})]})},oe=m.a.create({container:ne({flex:1,alignItems:"center",padding:24},w.a.select({web:{width:400},default:"100%"})),loginButton:{width:"100%"}}),ce=r(81),se=r(207),ie=function(e){var t=e.onBack;return Object(W.jsx)(H.a,{style:de.backButton,onPress:t,children:Object(W.jsxs)(g.a,{style:de.backContainer,children:[Object(W.jsx)(se.a,{name:"arrow-back",size:28,color:"white"}),Object(W.jsx)(A.a,{style:de.backButtonText,children:"Back"})]})})},ue=function(e){var t=e.onPress,r=e.text;return Object(W.jsx)(H.a,{style:de.rightButton,onPress:t,children:Object(W.jsx)(g.a,{style:de.backContainer,children:Object(W.jsx)(A.a,{style:de.rightButtonText,children:r})})})},le=function(){return Object(W.jsx)(g.a,{style:de.container})},de=m.a.create({container:{width:"100%",height:"100%",backgroundColor:G.primary},backContainer:{display:"flex",flexDirection:"row",alignItems:"center"},backButton:{width:40},backButtonText:{color:G.white,fontWeight:"bold",marginLeft:4},rightButton:{},rightButtonText:{color:G.white,fontWeight:"bold",marginRight:4}}),be=function(e){return Number.parseFloat(e.replace(/,/g,"."))},je=R.injectEndpoints({endpoints:function(e){return{calculate:e.mutation({query:function(e){var t=e.operand1,r=e.operand2,n=e.operator,a=e.client_id,o="";switch(n){case"+":o="add";break;case"-":o="subtract";break;case"*":o="multiply";break;case"/":o="divide"}return{url:"api/v1/calculators/"+o,method:"POST",body:{number1:be(t),number2:be(r),client_id:a}}}}),fetchSessions:e.query({query:function(e){return{url:"/api/v1/students/"+e+"/sessions",method:"GET"}},providesTags:["session"]}),sessionStart:e.mutation({query:function(){return{url:"api/v1/sessions/start",method:"POST"}}}),sessionStop:e.mutation({query:function(e){return{url:"api/v1/sessions/"+e+"/end",method:"POST",body:""}},invalidatesTags:["session"]})}}}),fe=je.useCalculateMutation,pe=je.useFetchSessionsQuery,he=je.useSessionStartMutation,Oe=je.useSessionStopMutation;function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){y()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ge,me=function(e){var t=e.text,r=e.onClick,n=e.disabled;return Object(W.jsx)(H.a,{style:we.button,onPress:function(){r(t)},disabled:n,children:Object(W.jsx)(A.a,{style:we.buttonText,children:t})})},ve=function(e){var t=e.calculate,r=e.loading,n=e.result,a=Object(l.useState)({operand1:"",operand2:"",operator:"",result:null!=n?n:""}),o=c()(a,2),s=o[0],i=o[1];Object(l.useEffect)((function(){i((function(e){return ye(ye({},e),{},{result:n})}))}),[n]);var u=function(e){var n=s.operator?"operand2":"operand1";if("AC"===e)i({operand1:"",operand2:"",operator:"",result:""});else if(/[\d,]/g.test(e)){if(/,/g.test(e)&&/,/g.test(s[n]))return;i((function(t){return t.result?{operand1:e,operand2:"",operator:"",result:""}:ye(ye({},t),{},y()({},n,s[n].concat(e)))}))}else if(/[/x\-*+]/.test(e)){if(!s.operand1)return;i((function(t){return ye(ye({},t),{},{operator:e})}))}else"="===e&&(r||t(s.operand1,s.operand2,s.operator))};return Object(W.jsxs)(g.a,{style:we.container,children:[Object(W.jsx)(g.a,{style:we.screen,children:Object(W.jsxs)(A.a,{style:we.screenText,children:[s.operand1," ",s.operator," ",s.operand2,s.result?Object(W.jsxs)(A.a,{style:we.resultText,children:["= ",s.result.toString().replace(/\./g,",")]}):null]})}),Object(W.jsxs)(g.a,{style:we.buttonGroup,children:[Object(W.jsxs)(g.a,{style:we.row,children:[Object(W.jsx)(me,{text:"AC",onClick:u}),Object(W.jsx)(me,{text:"",onClick:u,disabled:!0}),Object(W.jsx)(me,{text:"",onClick:u,disabled:!0}),Object(W.jsx)(me,{text:"/",onClick:u})]}),Object(W.jsxs)(g.a,{style:we.row,children:[Object(W.jsx)(me,{text:"7",onClick:u}),Object(W.jsx)(me,{text:"8",onClick:u}),Object(W.jsx)(me,{text:"9",onClick:u}),Object(W.jsx)(me,{text:"*",onClick:u})]}),Object(W.jsxs)(g.a,{style:we.row,children:[Object(W.jsx)(me,{text:"4",onClick:u}),Object(W.jsx)(me,{text:"5",onClick:u}),Object(W.jsx)(me,{text:"6",onClick:u}),Object(W.jsx)(me,{text:"-",onClick:u})]}),Object(W.jsxs)(g.a,{style:we.row,children:[Object(W.jsx)(me,{text:"1",onClick:u}),Object(W.jsx)(me,{text:"2",onClick:u}),Object(W.jsx)(me,{text:"3",onClick:u}),Object(W.jsx)(me,{text:"+",onClick:u})]}),Object(W.jsxs)(g.a,{style:we.row,children:[Object(W.jsx)(me,{text:"0",onClick:u}),Object(W.jsx)(me,{text:"",onClick:u,disabled:!0}),Object(W.jsx)(me,{text:",",onClick:u}),Object(W.jsx)(me,{text:"=",onClick:u,disabled:r})]})]})]})},we=m.a.create({container:{width:"100%",marginTop:24,maxWidth:500,height:330},row:{display:"flex",flex:4,height:48,width:"100%",flexDirection:"row"},buttonGroup:{width:"100%",height:264},button:{flex:1,margin:4,height:48,alignItems:"center",justifyContent:"center",textTransform:"uppercase",width:"100%",backgroundColor:G.primary,borderRadius:4},buttonText:{color:"#ffffff",fontWeight:"bold",fontSize:16},screen:{padding:8,justifyContent:"center",backgroundColor:"#dbdbdb",marginBottom:16,height:80},screenText:{fontWeight:"bold",fontSize:24,textAlign:"right"},resultText:{fontWeight:"bold",fontSize:28,textAlign:"right"}}),Se=m.a.create({container:{flex:1,width:"100%",alignItems:"center",padding:24,marginTop:48}}),ke=function(e){var t=e.navigation,r=fe(),n=c()(r,2),a=n[0],o=n[1],s=o.isLoading,u=o.data,d=function(){return t.navigate("apps")};Object(l.useLayoutEffect)((function(){t.setOptions({headerLeft:function(){return Object(W.jsx)(ie,{onBack:d})}})}),[t]);return Object(W.jsx)(ce.a,{style:Se.container,children:Object(W.jsx)(ve,{calculate:function(e,t,r){return i.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.a.awrap(a({operand1:e,operand2:t,operator:r,client_id:w.a.OS}));case 2:case"end":return n.stop()}}),null,null,null,Promise)},loading:s,result:null==u?void 0:u.result})})},Pe=r(99),Ce=r(82),Te=Object(b.d)({name:"calculator",initialState:{activeSession:void 0},reducers:{setActiveSession:function(e,t){e.activeSession=t.payload}},extraReducers:function(e){e.addMatcher(je.endpoints.sessionStart.matchFulfilled,(function(e,t){e.activeSession=t.payload})).addMatcher(je.endpoints.fetchSessions.matchFulfilled,(function(e,t){e.activeSession=t.payload})).addMatcher(je.endpoints.sessionStop.matchFulfilled,(function(e){e.activeSession=void 0}))}}),Ee=(Te.actions.setActiveSession,Te.reducer),Be=function(e){return e.calculator},_e=function(e){var t,r,n=e.navigation,a=O(),o=function(){var e=Object(d.e)(Be);return Object(l.useMemo)((function(){return e}),[e])}(),s=Object(d.d)(),u=pe(null==(t=a.user)?void 0:t.id).isLoading,b=he(),j=c()(b,2),p=j[0],h=j[1],x=h.error,y=h.isError,m=h.isLoading,v=Oe(),S=c()(v,1)[0];Object(l.useLayoutEffect)((function(){n.setOptions({headerRight:function(){return Object(W.jsx)(ue,{onPress:T,text:"Change user"})}})}),[n,o]),Object(l.useEffect)((function(){var e=Ce.a.addEventListener("hardwareBackPress",(function(){return Pe.a.alert("Warning!","Are you sure you want to continue? Your session wil be ended",[{text:"Cancel",onPress:function(){return null},style:"cancel"},{text:"OK",onPress:function(){return C()}}]),!0}));return function(){return e.remove()}}),[]);var k=function(){p()},P=function(){var e;return i.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("STARTED"!==(null==o||null==(e=o.activeSession)?void 0:e.status)){t.next=3;break}return t.next=3,i.a.awrap(S(o.activeSession.id));case 3:case"end":return t.stop()}}),null,null,null,Promise)},C=function(){return i.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.a.awrap(P());case 2:s(f({}));case 3:case"end":return e.stop()}}),null,null,null,Promise)},T=function(){return"web"===w.a.OS?C():Pe.a.alert("Warning!","Are you sure you want to continue? Your session wil be ended",[{text:"Cancel",onPress:function(){return null},style:"cancel"},{text:"OK",onPress:function(){return C()}}])},E=function(){n.push("calculator")};return Object(W.jsx)(ce.a,{style:De.safeArea,children:Object(W.jsxs)(g.a,{style:De.container,children:[y&&Object(W.jsx)(F,{text:null==x||null==(r=x.data)?void 0:r.message}),function(){var e=(o||{}).activeSession;return u?Object(W.jsx)(A.a,{children:"Loading..."}):e&&e.is_active?e&&"STARTED"!==e.status?Object(W.jsx)(Z,{onClick:k,text:m?"Starting":"Start session",disabled:m}):Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Z,{style:De.button,text:"Open Calculator",onClick:E}),Object(W.jsx)(Z,{style:De.button,text:"End session",onClick:P,type:"secondary"})]}):Object(W.jsx)(F,{text:"You don't have any active session"})}()]})})},De=m.a.create({safeArea:{flex:1,alignItems:"center",alignSelf:"center",width:"100%",height:"100%"},container:{flex:1,alignItems:"center",alignSelf:"center",padding:24,maxWidth:"web"===w.a.OS?400:"100%",width:"100%"},button:{width:"100%",marginTop:24}}),Le=Object(u.a)(),Ie=function(){var e=O(),t=Object(l.useState)(!0),r=c()(t,2),n=r[0],a=r[1],o=Object(l.useMemo)((function(){return e&&e.user}),[null==e?void 0:e.user]),s=Object(d.d)();return Object(l.useEffect)((function(){!function(){var e,t;i.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,i.a.awrap(B.a.getItem("@user"));case 3:e=r.sent,t=null!=e?JSON.parse(e):null,e&&s(f(t)),a(!1),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),a(!1);case 12:case"end":return r.stop()}}),null,null,[[0,9]],Promise)}()}),[s,f]),n?null:Object(W.jsx)(Le.Navigator,{initialRouteName:"apps",children:o?Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(Le.Screen,{name:"apps",component:_e,options:{headerBackVisible:!1,headerTitle:"",headerBackground:function(){return Object(W.jsx)(le,{})}}}),Object(W.jsx)(Le.Screen,{name:"calculator",component:ke,options:{headerBackVisible:!1,headerTitle:"",headerBackground:function(){return Object(W.jsx)(le,{})}}})]}):Object(W.jsx)(Le.Screen,{name:"login",component:ae,options:{header:function(){return null}}})})},Re=Object(b.a)({reducer:(ge={},y()(ge,R.reducerPath,R.reducer),y()(ge,"auth",p),y()(ge,"calculator",Ee),ge),middleware:function(e){return e().concat(R.middleware)}}),ze=r(205);function Ae(){return Object(W.jsx)(d.a,{store:Re,children:Object(W.jsx)(ze.a,{children:Object(W.jsx)(Ie,{})})})}},155:function(e,t,r){e.exports=r(196)}},[[155,1,2]]]);
//# sourceMappingURL=app.49b02ce4.chunk.js.map